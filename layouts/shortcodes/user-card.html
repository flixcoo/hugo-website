{{- $link := .Get "link" -}}
{{- $title := .Get "title" -}}
{{- $icon := .Get "icon" -}}
{{- $subtitle := .Get "subtitle" -}}
{{- $image := .Get "image" -}}
{{- $width := .Get "width" -}}
{{- $height := .Get "height" -}}
{{- $imageStyle := .Get "imageStyle" -}}
{{- $tag := .Get "tag" -}}
{{- $tagColor := .Get "tagColor" | default (.Get "tagType") | default "" -}}
{{- $tagBorder := not (eq (.Get "tagBorder") "false") | default true -}}
{{- $tagIcon := .Get "tagIcon" -}}

{{- $linkClass := "hx:hover:border-gray-300 hx:bg-transparent hx:shadow-xs hx:dark:border-neutral-800 hx:hover:bg-slate-50 hx:hover:shadow-md hx:dark:hover:border-neutral-700 hx:dark:hover:bg-neutral-900" -}}

{{- $external := strings.HasPrefix $link "http" -}}
{{- $href := cond (strings.HasPrefix $link "/") ($link | relURL) $link -}}

<a
    class="hextra-card hx:group hx:flex hx:flex-row hx:items-center hx:justify-start hx:overflow-hidden hx:rounded-lg hx:border hx:border-gray-200 hx:text-current hx:no-underline hx:dark:shadow-none hx:hover:shadow-gray-100 hx:dark:hover:shadow-none hx:shadow-gray-100 hx:active:shadow-sm hx:active:shadow-gray-200 hx:transition-all hx:duration-200 {{ $linkClass }}"
    {{- if $link -}}
        href="{{ $href }}"
        {{- with $external }}target="_blank"
        rel="noreferrer" {{ end -}}
    {{- end -}}
>
    {{- if or $image $icon -}}
    <div class="hx:flex hx:items-center hx:justify-center hx:p-4 hx:pr-0">
        {{- with $image -}}
        <div class="hx:w-16 hx:h-16 hx:flex hx:items-center hx:justify-center hx:overflow-hidden hx:rounded-md">
            <img
                alt="{{ $title }}"
                class="hextra-card-image hx:w-full hx:h-full hx:object-cover"
                loading="lazy"
                decoding="async"
                src="{{ $image | safeURL }}"
                {{- with $width }}width="{{ . }}" {{ end -}}
                {{- with $height }}height="{{ . }}" {{ end -}}
                {{- with $imageStyle }}style="{{ . | safeCSS }}" {{ end -}}
            />
        </div>
        {{- else -}}
        <div class="hx:w-16 hx:h-16 hx:flex hx:items-center hx:justify-center">
            {{- partial "utils/icon.html" (dict "name" $icon "attributes" "height=32") -}}
        </div>
        {{- end -}}
    </div>
    {{- end -}}

    <div class="hx:flex hx:flex-col hx:flex-1 hx:min-w-0 {{ if or $image $icon }}hx:py-4 hx:pr-4{{ else }}hx:p-4{{ end }}">
        <div class="hextra-card-icon hx:flex hx:flex-col hx:gap-1">
      <span class="hx:flex hx:font-semibold hx:items-start hx:gap-2 hx:text-gray-700 hx:group-hover:text-gray-900 hx:dark:text-neutral-200 hx:dark:group-hover:text-neutral-50">
        {{- with $icon }}{{ if not $image }}{{ partial "utils/icon.html" (dict "name" $icon) }}{{ end }}{{ end -}}
        {{- $title -}}
      </span>
            {{- with $subtitle -}}
            <div class="hextra-card-subtitle hx:text-sm hx:font-normal hx:text-gray-500 hx:dark:text-gray-400 hx:mt-1">
                {{- $subtitle | markdownify -}}
            </div>
            {{- end -}}
        </div>

        {{- if $tag -}}
        <div class="hx:mt-2">
            {{- partial "shortcodes/badge.html" (dict
            "content" $tag
            "color" $tagColor
            "class" "hextra-card-tag"
            "border" $tagBorder
            "icon" $tagIcon
            )
            -}}
        </div>
        {{- end -}}
    </div>
</a>